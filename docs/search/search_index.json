{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Bitwarden Password Manager ESO","text":"<p>Welcome to the documentation for the Bitwarden Password Manager integration with External Secrets Operator (ESO).</p> <p>This Helm chart deploys a Bitwarden CLI instance that can be used by ESO to fetch secrets from your Bitwarden vault.</p>"},{"location":"#key-features","title":"Key Features","text":"<ul> <li>Bitwarden CLI Integration: Connects directly to your Bitwarden vault.</li> <li>External Secrets Operator Support: Seamlessly integrates with ESO via <code>ClusterSecretStore</code>.</li> <li>Secure Secret Management: Encourages the use of SOPS for encrypting sensitive credentials within your GitOps repository.</li> </ul>"},{"location":"#architecture","title":"Architecture","text":"<ol> <li>Bitwarden CLI Pod: Runs the Bitwarden CLI in \"serve\" mode, exposing a local API on port 8087.</li> <li>Kubernetes Service: Provides a stable endpoint for the CLI Pod.</li> <li>ClusterSecretStore: Configured as a Webhook provider that queries the CLI Pod's API.</li> <li>External Secrets Operator: Orchestrates the sync between the Bitwarden \"API\" and your Kubernetes Secrets.</li> </ol>"},{"location":"#getting-started","title":"Getting Started","text":"<p>To get started, you'll need to:</p> <ol> <li>Configure your Bitwarden credentials.</li> <li>Encrypt those credentials using SOPS.</li> <li>Deploy the Helm chart.</li> </ol> <p>Check the SOPS Secrets page for detailed instructions on encrypting your credentials.</p>"},{"location":"configuration/","title":"Configuration &amp; Security","text":"<p>This page explains the security features and configuration options available in this Helm chart.</p>"},{"location":"configuration/#serviceaccount","title":"ServiceAccount","text":"<p>By default, the chart creates a dedicated <code>ServiceAccount</code> for the Bitwarden CLI bridge.</p>"},{"location":"configuration/#why-a-dedicated-serviceaccount","title":"Why a dedicated ServiceAccount?","text":"<p>Even though the Bitwarden CLI doesn't directly interact with the Kubernetes API, a dedicated identity is crucial for:</p> <ol> <li>Cloud Identity (IRSA / Workload Identity): If you are using SOPS with a cloud provider's KMS (like AWS KMS, GCP KMS, or Azure Key Vault), the Pod needs permission to access that KMS. This is typically achieved by annotating the <code>ServiceAccount</code> with an IAM role.</li> <li>Security Isolation: It follows the principle of least privilege. Using the <code>default</code> service account is discouraged as it may have broader permissions than intended.</li> <li>Auditability: Actions performed by the Pod are clearly identified in Kubernetes audit logs under the specific <code>ServiceAccount</code> name.</li> </ol>"},{"location":"configuration/#configuration","title":"Configuration","text":"<pre><code>serviceAccount:\n  create: true\n  annotations:\n    # Example for AWS IRSA\n    # eks.amazonaws.com/role-arn: arn:aws:iam::123456789012:role/my-sops-kms-role\n  name: \"\" # Leave empty to use the fullname template\n</code></pre>"},{"location":"configuration/#security-context","title":"Security Context","text":"<p>To follow security best practices, you should run the Bitwarden CLI with a restricted security context.</p>"},{"location":"configuration/#hardening-example","title":"Hardening Example","text":"<p>You can configure these in your <code>values.yaml</code>:</p> <pre><code>podSecurityContext:\n  fsGroup: 2000\n\nsecurityContext:\n  capabilities:\n    drop:\n    - ALL\n  readOnlyRootFilesystem: true\n  runAsNonRoot: true\n  runAsUser: 1000\n</code></pre>"},{"location":"configuration/#resource-management","title":"Resource Management","text":"<p>It is highly recommended to set resource requests and limits to ensure cluster stability. The default values are conservative but should be adjusted based on your vault size and usage.</p> <pre><code>resources:\n  requests:\n    cpu: 100m\n    memory: 128Mi\n  limits:\n    memory: 256Mi\n</code></pre>"},{"location":"development/","title":"Development &amp; Contributions","text":"<p>This project uses Semantic Release to automate versioning and package publishing.</p>"},{"location":"development/#conventional-commits","title":"Conventional Commits","text":"<p>We follow the Conventional Commits specification for all pull requests and commits. This allows us to automatically:</p> <ol> <li>Determine the next version number (patch, minor, or major).</li> <li>Generate a <code>CHANGELOG.md</code> file.</li> <li>Publish GitHub releases.</li> </ol>"},{"location":"development/#commit-message-format","title":"Commit Message Format","text":"<p>Each commit message should consist of a header, a body, and a footer. The header has a special format that includes a type, a scope, and a subject:</p> <pre><code>&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;\n&lt;BLANK LINE&gt;\n&lt;body&gt;\n&lt;BLANK LINE&gt;\n&lt;footer&gt;\n</code></pre>"},{"location":"development/#common-types","title":"Common Types","text":"<ul> <li><code>feat</code>: A new feature (triggers a minor release).</li> <li><code>fix</code>: A bug fix (triggers a patch release).</li> <li><code>docs</code>: Documentation only changes.</li> <li><code>style</code>: Changes that do not affect the meaning of the code.</li> <li><code>refactor</code>: A code change that neither fixes a bug nor adds a feature.</li> <li><code>perf</code>: A code change that improves performance.</li> <li><code>test</code>: Adding missing tests or correcting existing tests.</li> <li><code>chore</code>: Changes to the build process or auxiliary tools and libraries.</li> </ul>"},{"location":"development/#breaking-changes","title":"Breaking Changes","text":"<p>A breaking change must be indicated by a <code>!</code> after the type/scope or by adding <code>BREAKING CHANGE:</code> in the footer. This triggers a major release.</p> <p>Example:</p> <pre><code>feat!: overhaul the secret store configuration\n</code></pre>"},{"location":"development/#release-workflow","title":"Release Workflow","text":"<p>When a commit is pushed to the <code>main</code> or <code>master</code> branch, a GitHub Action is triggered that utilizes a reusable workflow from <code>user-cube/reusable-cicd</code>.</p> <p>The workflow will: 1.  Analyze the commits using Conventional Commits. 2.  Update the <code>version</code> in <code>Chart.yaml</code> (via <code>semantic-release-helm</code>). 3.  Generate/update <code>CHANGELOG.md</code>. 4.  Commit those changes back to the repository using a dedicated GitHub App identity. 5.  Create a GitHub Tag and Release.</p>"},{"location":"development/#artifact-hub-integration","title":"Artifact Hub Integration","text":"<p>To list this chart on Artifact Hub:</p> <ol> <li>Hosting: The chart is automatically packaged and hosted on the <code>gh-pages</code> branch of this repository by the <code>Release Charts</code> workflow.</li> <li>Registration:<ul> <li>Go to Artifact Hub and log in.</li> <li>Click Control Panel &gt; Add Repository.</li> <li>Kind: Helm charts.</li> <li>Name: <code>bitwarden-password-manager-eso</code>.</li> <li>URL: <code>https://&lt;your-username&gt;.github.io/bitwarden-password-manager-eso/</code>.</li> </ul> </li> <li>Metadata: Branding, maintainer info, and categories are managed via the <code>artifacthub-pkg.yml</code> file in the root of the repository.</li> </ol>"},{"location":"development/#updating-changes","title":"Updating Changes","text":"<p>Artifact Hub will automatically pick up changes from the <code>artifacthub.io/changes</code> annotation in <code>artifacthub-pkg.yml</code>.</p>"},{"location":"development/#required-secrets","title":"Required Secrets","text":"<p>To function correctly, the repository must have the following secrets configured (used by the reusable workflow): - <code>DEVOPS_BUDDY_APP_ID</code>: The ID of the GitHub App used for automation. - <code>DEVOPS_BUDDY_PRIVATE_KEY</code>: The private key of the GitHub App.</p>"},{"location":"sops-secrets/","title":"SOPS Encrypted Secrets","text":"<p>This guide explains how to create and use SOPS-encrypted secrets with this Helm chart.</p>"},{"location":"sops-secrets/#prerequisites","title":"Prerequisites","text":"<ul> <li>SOPS installed.</li> <li>An encryption key (Age, PGP, AWS KMS, GCP KMS, or Azure Key Vault).</li> </ul>"},{"location":"sops-secrets/#encrypting-bitwarden-credentials","title":"Encrypting Bitwarden Credentials","text":"<p>The Helm chart expects Bitwarden credentials in your <code>values.yaml</code>. To keep these secure, you should use SOPS to encrypt a separate secrets file (e.g., <code>secrets.dec.yaml</code>) and only commit the encrypted version (<code>secrets.enc.yaml</code>).</p>"},{"location":"sops-secrets/#1-create-your-decrypted-secrets-file","title":"1. Create your decrypted secrets file","text":"<p>Create a file named <code>secrets.dec.yaml</code> with your credentials:</p> <pre><code>bitwarden:\n  username: \"your-email@example.com\"\n  password: \"your-master-password\"\n  clientId: \"your-client-id\"\n  clientSecret: \"your-client-secret\"\n</code></pre>"},{"location":"sops-secrets/#2-encrypt-the-file","title":"2. Encrypt the file","text":"<p>You can encrypt the file using various methods. It is highly recommended to use a <code>.sops.yaml</code> configuration file to manage your keys.</p>"},{"location":"sops-secrets/#using-age-recommended-for-simple-setups","title":"Using Age (Recommended for simple setups)","text":"<pre><code>sops --encrypt --age &lt;your-age-public-key&gt; secrets.dec.yaml &gt; secrets.enc.yaml\n</code></pre>"},{"location":"sops-secrets/#using-pgp","title":"Using PGP","text":"<pre><code>sops --encrypt --pgp &lt;your-pgp-fingerprint&gt; secrets.dec.yaml &gt; secrets.enc.yaml\n</code></pre>"},{"location":"sops-secrets/#using-aws-kms","title":"Using AWS KMS","text":"<pre><code>sops --encrypt --kms &lt;your-kms-arn&gt; secrets.dec.yaml &gt; secrets.enc.yaml\n</code></pre>"},{"location":"sops-secrets/#using-gcp-kms","title":"Using GCP KMS","text":"<pre><code>sops --encrypt --gcp-kms &lt;your-gcp-kms-resource-id&gt; secrets.dec.yaml &gt; secrets.enc.yaml\n</code></pre>"},{"location":"sops-secrets/#3-using-a-sopsyaml-configuration-best-practice","title":"3. Using a .sops.yaml configuration (Best Practice)","text":"<p>Instead of passing flags every time, create a <code>.sops.yaml</code> file in the root of your project. This allows you to define which keys to use for which files.</p> <p>Example <code>.sops.yaml</code>:</p> <pre><code>creation_rules:\n  - path_regex: .*\\.enc\\.yaml$\n    # Use multiple keys for redundancy (Multi-key encryption)\n    age: &gt;-\n      age1ql3z7hjy54pw3ul4lshj32atxy9690s3at38f699as898v68s9ps9sh72y,\n      age123...\n    pgp: &gt;-\n      1234567890ABCDEF1234567890ABCDEF12345678\n    kms: 'arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012'\n</code></pre> <p>With this file in place, you can simply run:</p> <pre><code>sops --encrypt secrets.dec.yaml &gt; secrets.enc.yaml\n</code></pre>"},{"location":"sops-secrets/#4-using-the-encrypted-secrets-with-helm","title":"4. Using the encrypted secrets with Helm","text":"<p>The most efficient way to use SOPS-encrypted secrets with Helm is the helm-secrets plugin.</p>"},{"location":"sops-secrets/#install-helm-secrets","title":"Install helm-secrets","text":"<pre><code>helm plugin install https://github.com/jkroepke/helm-secrets\n</code></pre>"},{"location":"sops-secrets/#common-commands","title":"Common Commands","text":"Action Command Install <code>helm secrets install bitwarden-password-manager-eso . -f values.yaml -f secrets.enc.yaml</code> Upgrade <code>helm secrets upgrade bitwarden-password-manager-eso . -f values.yaml -f secrets.enc.yaml</code> Template <code>helm secrets template bitwarden-password-manager-eso . -f values.yaml -f secrets.enc.yaml</code> Edit <code>helm secrets edit secrets.enc.yaml</code> (Decrypts, opens in editor, re-encrypts on save) View <code>helm secrets view secrets.enc.yaml</code> (Shows decrypted content in stdout)"},{"location":"sops-secrets/#alternative-manual-decryption","title":"Alternative: Manual decryption","text":"<p>If you cannot use the plugin, you can decrypt the file on the fly:</p> <pre><code>sops exec-file secrets.enc.yaml 'helm install bitwarden-password-manager-eso . -f values.yaml -f {}'\n</code></pre>"},{"location":"sops-secrets/#security-best-practices","title":"Security Best Practices","text":"<ul> <li>Never commit <code>secrets.dec.yaml</code> to your repository. Add it to <code>.gitignore</code>.</li> <li>Commit <code>.sops.yaml</code> to your repository so other contributors (and CI/CD) know which keys to use for decryption.</li> <li>Rotate your Bitwarden credentials and encryption keys periodically.</li> <li>Use a dedicated Bitwarden account with minimal permissions for this integration.</li> </ul>"},{"location":"usage/","title":"Usage Guide","text":"<p>This guide explains how to use the <code>ClusterSecretStore</code> created by this chart to fetch secrets from Bitwarden into your Kubernetes namespace.</p>"},{"location":"usage/#how-it-works","title":"How it works","text":"<p>The Helm chart deploys a Bitwarden CLI instance and automatically creates several <code>ClusterSecretStore</code> resources. These stores use the ESO Webhook Provider to talk to the Bitwarden CLI bridge.</p>"},{"location":"usage/#default-clustersecretstores","title":"Default ClusterSecretStores","text":"<p>By default, the chart creates the following <code>ClusterSecretStore</code> resources:</p> <ul> <li><code>bitwarden-login</code>: For fetching usernames.</li> <li><code>bitwarden-password</code>: For fetching passwords.</li> <li><code>bitwarden-fields</code>: For fetching custom fields.</li> <li><code>bitwarden-notes</code>: For fetching notes.</li> <li><code>bitwarden-attachments</code>: For fetching attachments.</li> </ul>"},{"location":"usage/#creating-an-externalsecret","title":"Creating an ExternalSecret","text":"<p>To fetch a secret from Bitwarden, create an <code>ExternalSecret</code> resource in your namespace.</p>"},{"location":"usage/#example-fetching-a-login-username-and-password","title":"Example: Fetching a Login (Username and Password)","text":"<p>The <code>remoteRef.key</code> should be the ID of the item in your Bitwarden vault. You can find this ID in the Bitwarden web vault URL or via the CLI.</p> <pre><code>apiVersion: external-secrets.io/v1beta1\nkind: ExternalSecret\nmetadata:\n  name: my-app-credentials\nspec:\n  refreshInterval: \"1h\"\n  secretStoreRef:\n    name: bitwarden-password # Use the appropriate store\n    kind: ClusterSecretStore\n  target:\n    name: my-app-k8s-secret # The name of the Secret to create in K8s\n    creationPolicy: Owner\n  data:\n    - secretKey: password\n      remoteRef:\n        key: \"your-bitwarden-item-uuid\"\n---\napiVersion: external-secrets.io/v1beta1\nkind: ExternalSecret\nmetadata:\n  name: my-app-username\nspec:\n  refreshInterval: \"1h\"\n  secretStoreRef:\n    name: bitwarden-login\n    kind: ClusterSecretStore\n  target:\n    name: my-app-k8s-username\n  data:\n    - secretKey: username\n      remoteRef:\n        key: \"your-bitwarden-item-uuid\"\n</code></pre>"},{"location":"usage/#finding-the-bitwarden-item-uuid","title":"Finding the Bitwarden Item UUID","text":"<ol> <li>Log in to the Bitwarden Web Vault.</li> <li>Click on the item you want to use.</li> <li>Look at the URL in your browser. It will look like: <code>https://vault.bitwarden.com/#/vault?itemID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</code>.</li> <li>The string after <code>itemID=</code> is your UUID.</li> </ol>"},{"location":"usage/#periodic-vault-sync","title":"Periodic Vault Sync","text":"<p>The Bitwarden CLI bridge needs to be synced with the Bitwarden cloud to pick up changes (e.g., when you update a password in the web vault).</p> <p>This chart includes an optional <code>CronJob</code> that can trigger this sync periodically.</p>"},{"location":"usage/#enabling-sync","title":"Enabling Sync","text":"<p>To enable the sync CronJob, update your <code>values.yaml</code>:</p> <pre><code>sync:\n  enabled: true\n  schedule: \"0 * * * *\" # Every hour (standard cron expression)\n</code></pre>"},{"location":"usage/#manual-sync","title":"Manual Sync","text":"<p>You can also trigger a sync manually at any time by running a curl command from within the cluster:</p> <pre><code>kubectl run curl --image=curlimages/curl -i --tty --rm -- \\\n  curl -X POST http://bitwarden-password-manager-eso.default.svc.cluster.local:8087/sync\n</code></pre>"}]}